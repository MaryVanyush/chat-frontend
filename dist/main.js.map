{"version":3,"file":"main.js","mappings":";;;;;AAAe,MAAMA,GAAG,CAAC;EACvBC,WAAWA,CAACC,MAAM,EAAE;IAClB,IAAI,CAACA,MAAM,GAAGA,MAAM;EACtB;EAEA,MAAMC,OAAOA,CAACC,IAAI,EAAE;IAClB,MAAMC,OAAO,GAAGC,KAAK,CAAC,IAAI,CAACJ,MAAM,GAAG,QAAQ,EAAE;MAC5CK,MAAM,EAAE,MAAM;MACdC,OAAO,EAAE;QACP,cAAc,EAAE;MAClB,CAAC;MACDC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAACP,IAAI;IAC3B,CAAC,CAAC;IACF,MAAMQ,MAAM,GAAG,MAAMP,OAAO;IAC5B,MAAMQ,IAAI,GAAG,MAAMD,MAAM,CAACC,IAAI,CAAC,CAAC;IAChC,OAAOA,IAAI;EACb;EAEA,MAAMC,OAAOA,CAAA,EAAG;IACd,MAAMT,OAAO,GAAGC,KAAK,CAAC,IAAI,CAACJ,MAAM,GAAG,QAAQ,EAAE;MAC5CK,MAAM,EAAE,KAAK;MACbC,OAAO,EAAE;QACP,cAAc,EAAE;MAClB;IACF,CAAC,CAAC;IACF,MAAMI,MAAM,GAAG,MAAMP,OAAO;IAC5B,MAAMQ,IAAI,GAAG,MAAMD,MAAM,CAACC,IAAI,CAAC,CAAC;IAChC,OAAOA,IAAI;EACb;EAEA,MAAME,UAAUA,CAACX,IAAI,EAAE;IACrB,MAAMY,KAAK,GAAG,QAAQ,GAAGC,kBAAkB,CAACb,IAAI,CAACc,IAAI,CAAC;IACtD,MAAMb,OAAO,GAAGC,KAAK,CAAC,IAAI,CAACJ,MAAM,GAAGc,KAAK,EAAE;MACzCT,MAAM,EAAE,QAAQ;MAChBC,OAAO,EAAE;QACP,cAAc,EAAE;MAClB;IACF,CAAC,CAAC;IACF,MAAMI,MAAM,GAAG,MAAMP,OAAO;IAC5B,IAAI,CAACO,MAAM,CAACO,EAAE,EAAE;MACdC,OAAO,CAACC,KAAK,CAAC,OAAO,CAAC;MACtB;IACF;IACA,MAAMR,IAAI,GAAG,MAAMD,MAAM,CAACC,IAAI,CAAC,CAAC;IAChC,MAAMS,MAAM,GAAGT,IAAI,CAACS,MAAM;IAC1BF,OAAO,CAACG,GAAG,CAACD,MAAM,CAAC;EACrB;AACF;;AC/Ce,MAAME,KAAK,CAAC;EACzBvB,WAAWA,CAACwB,QAAQ,EAAE;IACpB,IAAI,CAACA,QAAQ,GAAGA,QAAQ;EAC1B;EAEAtB,OAAOA,CAACuB,IAAI,EAAE;IACZ,MAAMC,SAAS,GAAG,CAAC,GAAGC,QAAQ,CAACC,gBAAgB,CAAC,YAAY,CAAC,CAAC;IAC9D,MAAMC,MAAM,GAAGH,SAAS,CAACI,MAAM,CAAEC,IAAI,IAAKA,IAAI,CAACC,OAAO,CAACf,IAAI,CAAC;IAC5D,MAAMA,IAAI,GAAGY,MAAM,CAAC,CAAC,CAAC,CAACG,OAAO,CAACf,IAAI;IACnC,IAAIA,IAAI,KAAKQ,IAAI,CAACQ,UAAU,IAAIhB,IAAI,KAAKQ,IAAI,CAACR,IAAI,EAAE;IACpD,MAAMd,IAAI,GAAG,IAAI,CAAC+B,UAAU,CAACT,IAAI,CAAC;IAClC,IAAI,CAACD,QAAQ,CAACW,WAAW,CAAChC,IAAI,CAAC;EACjC;EAEA+B,UAAUA,CAACT,IAAI,EAAE;IACf,MAAMtB,IAAI,GAAGwB,QAAQ,CAACS,aAAa,CAAC,IAAI,CAAC;IACzCjC,IAAI,CAACkC,SAAS,GAAG,WAAW;IAC5B,MAAMC,SAAS,GAAGX,QAAQ,CAACS,aAAa,CAAC,KAAK,CAAC;IAC/CE,SAAS,CAACD,SAAS,GAAG,YAAY;IAClC,MAAME,QAAQ,GAAGZ,QAAQ,CAACS,aAAa,CAAC,MAAM,CAAC;IAC/CG,QAAQ,CAACF,SAAS,GAAG,WAAW;IAChC,IAAIZ,IAAI,CAACR,IAAI,EAAE;MACbsB,QAAQ,CAACC,WAAW,GAAGf,IAAI,CAACR,IAAI;IAClC,CAAC,MAAM;MACLsB,QAAQ,CAACC,WAAW,GAAGf,IAAI,CAACQ,UAAU;IACxC;IACA9B,IAAI,CAACgC,WAAW,CAACG,SAAS,CAAC;IAC3BnC,IAAI,CAACgC,WAAW,CAACI,QAAQ,CAAC;IAC1B,OAAOpC,IAAI;EACb;AACF;;AC9Be,MAAMsC,QAAQ,CAAC;EAC5BzC,WAAWA,CAAC0C,WAAW,EAAE;IACvB,IAAI,CAACA,WAAW,GAAGA,WAAW;EAChC;EAEAC,UAAUA,CAAClB,IAAI,EAAE;IACf,MAAMC,SAAS,GAAG,CAAC,GAAGC,QAAQ,CAACC,gBAAgB,CAAC,YAAY,CAAC,CAAC;IAC9D,MAAMC,MAAM,GAAGH,SAAS,CAACI,MAAM,CAAEC,IAAI,IAAKA,IAAI,CAACC,OAAO,CAACf,IAAI,CAAC;IAC5D,IAAI,CAACY,MAAM,CAAC,CAAC,CAAC,EAAE;IAChB,MAAMe,OAAO,GAAG,IAAI,CAACC,aAAa,CAACpB,IAAI,EAAEI,MAAM,CAAC;IAChD,IAAI,CAACa,WAAW,CAACP,WAAW,CAACS,OAAO,CAAC;EACvC;EAEAC,aAAaA,CAACpB,IAAI,EAAEI,MAAM,EAAE;IAC1B,MAAMe,OAAO,GAAGjB,QAAQ,CAACS,aAAa,CAAC,KAAK,CAAC;IAC7CQ,OAAO,CAACP,SAAS,GAAG,SAAS;IAC7B,MAAMS,WAAW,GAAGnB,QAAQ,CAACS,aAAa,CAAC,MAAM,CAAC;IAClDU,WAAW,CAACT,SAAS,GAAG,cAAc;IACtC,MAAMU,IAAI,GAAG,IAAI,CAACC,OAAO,CAACvB,IAAI,CAACsB,IAAI,CAAC;IACpC,MAAM9B,IAAI,GAAGY,MAAM,CAAC,CAAC,CAAC,CAACG,OAAO,CAACf,IAAI;IACnC,IAAIA,IAAI,KAAKQ,IAAI,CAACR,IAAI,EAAE;MACtB2B,OAAO,CAACP,SAAS,CAACY,GAAG,CAAC,KAAK,CAAC;MAC5BH,WAAW,CAACT,SAAS,CAACY,GAAG,CAAC,KAAK,CAAC;MAChCH,WAAW,CAACN,WAAW,GAAG,OAAO,GAAGO,IAAI;IAC1C,CAAC,MAAM;MACLD,WAAW,CAACN,WAAW,GAAGf,IAAI,CAACR,IAAI,GAAG,IAAI,GAAG8B,IAAI;IACnD;IACA,MAAMG,WAAW,GAAGvB,QAAQ,CAACS,aAAa,CAAC,KAAK,CAAC;IACjDc,WAAW,CAACb,SAAS,GAAG,cAAc;IACtCa,WAAW,CAACV,WAAW,GAAGf,IAAI,CAACmB,OAAO;IACtCA,OAAO,CAACT,WAAW,CAACW,WAAW,CAAC;IAChCF,OAAO,CAACT,WAAW,CAACe,WAAW,CAAC;IAChC,OAAON,OAAO;EAChB;EAEAI,OAAOA,CAACG,UAAU,EAAE;IAClB,MAAMC,aAAa,GAAG,IAAIC,IAAI,CAACF,UAAU,CAAC,CACvCG,cAAc,CAAC,OAAO,EAAE;MACvBC,GAAG,EAAE,SAAS;MACdC,KAAK,EAAE,SAAS;MAChBC,IAAI,EAAE,SAAS;MACfC,IAAI,EAAE,SAAS;MACfC,MAAM,EAAE,SAAS;MACjBC,MAAM,EAAE;IACV,CAAC,CAAC,CACDC,KAAK,CAAC,GAAG,CAAC,CACVC,IAAI,CAAC,EAAE,CAAC;IACX,OAAOV,aAAa;EACtB;AACF;;ACjDwB;AACI;AACM;;AAElC;AACA,MAAMW,GAAG,GAAG,IAAIhE,GAAG,CAAC,iCAAiC,CAAC;AACtD,MAAMyB,QAAQ,GAAGG,QAAQ,CAACqC,aAAa,CAAC,YAAY,CAAC;AACrD,MAAMC,KAAK,GAAG,IAAI1C,KAAK,CAACC,QAAQ,CAAC;;AAEjC;;AAEA,MAAM0C,YAAY,GAAGA,CAAA,KAAM;EACzB,MAAMxB,WAAW,GAAGf,QAAQ,CAACqC,aAAa,CAAC,eAAe,CAAC;EAC3D,MAAMG,IAAI,GAAG,IAAI1B,QAAQ,CAACC,WAAW,CAAC;EACtC,MAAM0B,YAAY,GAAGzC,QAAQ,CAACqC,aAAa,CAAC,gBAAgB,CAAC;EAC7D,MAAMtC,SAAS,GAAG,CAAC,GAAGC,QAAQ,CAACC,gBAAgB,CAAC,YAAY,CAAC,CAAC;EAC9D,MAAMC,MAAM,GAAGH,SAAS,CAACI,MAAM,CAAEC,IAAI,IAAKA,IAAI,CAACC,OAAO,CAACf,IAAI,CAAC;EAC5D,MAAMgB,UAAU,GAAGJ,MAAM,CAAC,CAAC,CAAC,CAACG,OAAO,CAACf,IAAI;EACzC;EACA,MAAMoD,EAAE,GAAG,IAAIC,SAAS,CAAC,iCAAiC,CAAC;EAE3DF,YAAY,CAACG,gBAAgB,CAAC,OAAO,EAAGC,KAAK,IAAK;IAChDA,KAAK,CAACC,cAAc,CAAC,CAAC;IACtB,IAAID,KAAK,CAACE,IAAI,KAAK,OAAO,EAAE;IAC5B,IAAI,CAACN,YAAY,CAACO,KAAK,EAAE;IACzB,MAAM5B,IAAI,GAAG,IAAIM,IAAI,CAAC,CAAC;IACvBgB,EAAE,CAACO,IAAI,CACLnE,IAAI,CAACC,SAAS,CAAC;MAAEO,IAAI,EAAEgB,UAAU;MAAEc,IAAI;MAAEH,OAAO,EAAEwB,YAAY,CAACO;IAAM,CAAC,CACxE,CAAC;IACDP,YAAY,CAACO,KAAK,GAAG,EAAE;EACzB,CAAC,CAAC;EAEFE,MAAM,CAACN,gBAAgB,CAAC,cAAc,EAAE,MAAM;IAC5CR,GAAG,CAACjD,UAAU,CAAC;MAAEG,IAAI,EAAEgB;IAAW,CAAC,CAAC;IACpCoC,EAAE,CAACO,IAAI,CAACnE,IAAI,CAACC,SAAS,CAAC;MAAEoE,MAAM,EAAE7C;IAAW,CAAC,CAAC,CAAC;EACjD,CAAC,CAAC;EAEFoC,EAAE,CAACE,gBAAgB,CAAC,MAAM,EAAGQ,CAAC,IAAK;IACjCV,EAAE,CAACO,IAAI,CAACnE,IAAI,CAACC,SAAS,CAAC;MAAEuB;IAAW,CAAC,CAAC,CAAC;EACzC,CAAC,CAAC;EAEFoC,EAAE,CAACE,gBAAgB,CAAC,OAAO,EAAGQ,CAAC,IAAK;IAClC5D,OAAO,CAACG,GAAG,CAACyD,CAAC,CAAC;IACd5D,OAAO,CAACG,GAAG,CAAC,UAAU,CAAC;EACzB,CAAC,CAAC;EAEF+C,EAAE,CAACE,gBAAgB,CAAC,OAAO,EAAGQ,CAAC,IAAK;IAClC5D,OAAO,CAACG,GAAG,CAACyD,CAAC,CAAC;IACd5D,OAAO,CAACG,GAAG,CAAC,UAAU,CAAC;EACzB,CAAC,CAAC;EAEF+C,EAAE,CAACE,gBAAgB,CAAC,SAAS,EAAGQ,CAAC,IAAK;IACpC,MAAMtD,IAAI,GAAGhB,IAAI,CAACuE,KAAK,CAACD,CAAC,CAACtD,IAAI,CAAC;IAC/B,MAAM;MAAEqD;IAAO,CAAC,GAAGrD,IAAI;IACvB,MAAM;MAAE0C,IAAI,EAAEc;IAAS,CAAC,GAAGxD,IAAI;IAC/B,MAAM;MAAEyD;IAAQ,CAAC,GAAGzD,IAAI;IACxB,IAAIwD,QAAQ,EAAE;MACZA,QAAQ,CAACE,OAAO,CAAEvC,OAAO,IAAK;QAC5BuB,IAAI,CAACxB,UAAU,CAACC,OAAO,CAAC;MAC1B,CAAC,CAAC;IACJ,CAAC,MAAM,IAAIsC,OAAO,EAAE;MAClBA,OAAO,CAACC,OAAO,CAAEtD,MAAM,IAAK;QAC1BoC,KAAK,CAAC/D,OAAO,CAAC2B,MAAM,CAAC;MACvB,CAAC,CAAC;IACJ,CAAC,MAAM,IAAIiD,MAAM,EAAE;MACjB,MAAMM,UAAU,GAAGN,MAAM,CAAC,CAAC,CAAC,CAACA,MAAM;MACnC,MAAMO,QAAQ,GAAG,CAAC,GAAGpB,KAAK,CAACzC,QAAQ,CAACI,gBAAgB,CAAC,YAAY,CAAC,CAAC;MACnEyD,QAAQ,CAACF,OAAO,CAAEhF,IAAI,IAAK;QACzB,IAAIA,IAAI,CAACqC,WAAW,KAAK4C,UAAU,EAAE;UACnC,IAAIrD,IAAI,GAAG5B,IAAI,CAACmF,OAAO,CAAC,YAAY,CAAC;UACrCvD,IAAI,CAACwD,MAAM,CAAC,CAAC;QACf;MACF,CAAC,CAAC;IACJ;EACF,CAAC,CAAC;AACJ,CAAC;;AAED;;AAEA,MAAMC,sBAAsB,GAAGA,CAAA,KAAM;EACnC,MAAMC,kBAAkB,GAAG9D,QAAQ,CAACqC,aAAa,CAAC,uBAAuB,CAAC;EAC1EyB,kBAAkB,CAACC,KAAK,CAACC,OAAO,GAAG,MAAM;EACzC,MAAMC,mBAAmB,GAAGH,kBAAkB,CAACzB,aAAa,CAC1D,wBACF,CAAC;EACD,MAAM6B,YAAY,GAAGA,CAAA,KAAM;IACzBJ,kBAAkB,CAACC,KAAK,CAACC,OAAO,GAAG,MAAM;IACzCG,UAAU,CAAC,CAAC;EACd,CAAC;EACDF,mBAAmB,CAACrB,gBAAgB,CAAC,OAAO,EAAEsB,YAAY,CAAC;AAC7D,CAAC;AAED,MAAME,OAAO,GAAIC,QAAQ,IAAK;EAC5B,MAAMC,UAAU,GAAGtE,QAAQ,CAACqC,aAAa,CAAC,cAAc,CAAC;EACzD,MAAMkC,SAAS,GAAGvE,QAAQ,CAACqC,aAAa,CAAC,gBAAgB,CAAC;EAC1D,MAAMmC,QAAQ,GAAGxE,QAAQ,CAACS,aAAa,CAAC,IAAI,CAAC;EAC7C+D,QAAQ,CAAC9D,SAAS,GAAG,WAAW;EAChC8D,QAAQ,CAACnE,OAAO,CAACf,IAAI,GAAG+E,QAAQ,CAAC/E,IAAI;EACrC,MAAMqB,SAAS,GAAGX,QAAQ,CAACS,aAAa,CAAC,KAAK,CAAC;EAC/CE,SAAS,CAACD,SAAS,GAAG,YAAY;EAClC,MAAME,QAAQ,GAAGZ,QAAQ,CAACS,aAAa,CAAC,MAAM,CAAC;EAC/CG,QAAQ,CAACF,SAAS,GAAG,WAAW;EAChCE,QAAQ,CAACF,SAAS,CAACY,GAAG,CAAC,KAAK,CAAC;EAC7BV,QAAQ,CAACC,WAAW,GAAG,KAAK;EAC5B2D,QAAQ,CAAChE,WAAW,CAACG,SAAS,CAAC;EAC/B6D,QAAQ,CAAChE,WAAW,CAACI,QAAQ,CAAC;EAC9B2D,SAAS,CAAC/D,WAAW,CAACgE,QAAQ,CAAC;EAC/BF,UAAU,CAACP,KAAK,CAACC,OAAO,GAAG,MAAM;AACnC,CAAC;AAED,MAAMG,UAAU,GAAGA,CAAA,KAAM;EACvB,MAAMM,aAAa,GAAGzE,QAAQ,CAACqC,aAAa,CAAC,iBAAiB,CAAC;EAC/DoC,aAAa,CAACV,KAAK,CAACC,OAAO,GAAG,MAAM;EACpC,MAAMU,YAAY,GAAGD,aAAa,CAACpC,aAAa,CAAC,gBAAgB,CAAC;EAClE,MAAMsC,cAAc,GAAGF,aAAa,CAACpC,aAAa,CAAC,kBAAkB,CAAC;EACtE,MAAMuC,QAAQ,GAAGA,CAAA,KAAM;IACrB/B,KAAK,CAACC,cAAc,CAAC,CAAC;IACtB,MAAMxD,IAAI,GAAGoF,YAAY,CAAC1B,KAAK;IAC/B,IAAI1D,IAAI,KAAK,EAAE,EAAE;IACjBoF,YAAY,CAAC1B,KAAK,GAAG,EAAE;IACvBZ,GAAG,CAAC7D,OAAO,CAAC;MAAEe;IAAK,CAAC,CAAC,CAACuF,IAAI,CAAER,QAAQ,IAAK;MACvC,IAAIA,QAAQ,CAAC3E,MAAM,KAAK,kBAAkB,EAAE;QAC1C+E,aAAa,CAACV,KAAK,CAACC,OAAO,GAAG,MAAM;QACpCH,sBAAsB,CAAC,CAAC;MAC1B,CAAC,MAAM;QACLY,aAAa,CAACV,KAAK,CAACC,OAAO,GAAG,MAAM;QACpCI,OAAO,CAACC,QAAQ,CAAC;QACjBjC,GAAG,CAAClD,OAAO,CAAC,CAAC,CAAC2F,IAAI,CAAER,QAAQ,IAAK;UAC/BA,QAAQ,CAACb,OAAO,CAAEtD,MAAM,IAAK;YAC3BoC,KAAK,CAAC/D,OAAO,CAAC2B,MAAM,CAAC;UACvB,CAAC,CAAC;UACFqC,YAAY,CAAC,CAAC;QAChB,CAAC,CAAC;MACJ;IACF,CAAC,CAAC;IAEFoC,cAAc,CAACG,mBAAmB,CAAC,OAAO,EAAEF,QAAQ,CAAC;EACvD,CAAC;EACDD,cAAc,CAAC/B,gBAAgB,CAAC,OAAO,EAAEgC,QAAQ,CAAC;AACpD,CAAC;AAED5E,QAAQ,CAAC4C,gBAAgB,CAAC,kBAAkB,EAAEuB,UAAU,CAAC;;AC7IhC","sources":["webpack://chat-frontend/./src/js/Api.js","webpack://chat-frontend/./src/js/Users.js","webpack://chat-frontend/./src/js/Messages.js","webpack://chat-frontend/./src/js/app.js","webpack://chat-frontend/./src/index.js"],"sourcesContent":["export default class Api {\n  constructor(apiUrl) {\n    this.apiUrl = apiUrl;\n  }\n\n  async addUser(user) {\n    const request = fetch(this.apiUrl + \"users/\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify(user),\n    });\n    const result = await request;\n    const json = await result.json();\n    return json;\n  }\n\n  async getUser() {\n    const request = fetch(this.apiUrl + \"users/\", {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n    });\n    const result = await request;\n    const json = await result.json();\n    return json;\n  }\n\n  async deleteUser(user) {\n    const query = \"users/\" + encodeURIComponent(user.name);\n    const request = fetch(this.apiUrl + query, {\n      method: \"DELETE\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n    });\n    const result = await request;\n    if (!result.ok) {\n      console.error(\"error\");\n      return;\n    }\n    const json = await result.json();\n    const status = json.status;\n    console.log(status);\n  }\n}\n","export default class Users {\n  constructor(usersBox) {\n    this.usersBox = usersBox;\n  }\n\n  addUser(data) {\n    const userItems = [...document.querySelectorAll(\".user-item\")];\n    const sender = userItems.filter((item) => item.dataset.name);\n    const name = sender[0].dataset.name;\n    if (name === data.senderName || name === data.name) return;\n    const user = this.createUser(data);\n    this.usersBox.appendChild(user);\n  }\n\n  createUser(data) {\n    const user = document.createElement(\"li\");\n    user.classList = \"user-item\";\n    const userImage = document.createElement(\"div\");\n    userImage.classList = \"user-image\";\n    const userName = document.createElement(\"span\");\n    userName.classList = \"user-name\";\n    if (data.name) {\n      userName.textContent = data.name;\n    } else {\n      userName.textContent = data.senderName;\n    }\n    user.appendChild(userImage);\n    user.appendChild(userName);\n    return user;\n  }\n}\n","export default class Messages {\n  constructor(messagesBox) {\n    this.messagesBox = messagesBox;\n  }\n\n  addMessage(data) {\n    const userItems = [...document.querySelectorAll(\".user-item\")];\n    const sender = userItems.filter((item) => item.dataset.name);\n    if (!sender[0]) return;\n    const message = this.createMessage(data, sender);\n    this.messagesBox.appendChild(message);\n  }\n\n  createMessage(data, sender) {\n    const message = document.createElement(\"div\");\n    message.classList = \"message\";\n    const dataMessage = document.createElement(\"span\");\n    dataMessage.classList = \"data-message\";\n    const date = this.getDate(data.date);\n    const name = sender[0].dataset.name;\n    if (name === data.name) {\n      message.classList.add(\"you\");\n      dataMessage.classList.add(\"you\");\n      dataMessage.textContent = \"You, \" + date;\n    } else {\n      dataMessage.textContent = data.name + \", \" + date;\n    }\n    const textMessage = document.createElement(\"div\");\n    textMessage.classList = \"text-message\";\n    textMessage.textContent = data.message;\n    message.appendChild(dataMessage);\n    message.appendChild(textMessage);\n    return message;\n  }\n\n  getDate(dateString) {\n    const formattedDate = new Date(dateString)\n      .toLocaleString(\"ru-RU\", {\n        day: \"numeric\",\n        month: \"numeric\",\n        year: \"numeric\",\n        hour: \"numeric\",\n        minute: \"numeric\",\n        hour12: false,\n      })\n      .split(\",\")\n      .join(\"\");\n    return formattedDate;\n  }\n}\n","import Api from \"./Api\";\nimport Users from \"./Users\";\nimport Messages from \"./Messages\";\n\n// const api = new Api(\"http://localhost:7070/\");\nconst api = new Api(\"https://chat-gj8s.onrender.com/\");\nconst usersBox = document.querySelector(\".users-box\");\nconst users = new Users(usersBox);\n\n//___________________________WS_________________________\n\nconst runWebSocket = () => {\n  const messagesBox = document.querySelector(\".messages-box\");\n  const chat = new Messages(messagesBox);\n  const messageInput = document.querySelector(\".message-input\");\n  const userItems = [...document.querySelectorAll(\".user-item\")];\n  const sender = userItems.filter((item) => item.dataset.name);\n  const senderName = sender[0].dataset.name;\n  // const ws = new WebSocket(\"ws://localhost:7070/ws\");\n  const ws = new WebSocket(\"wss://chat-gj8s.onrender.com/ws\");\n\n  messageInput.addEventListener(\"keyup\", (event) => {\n    event.preventDefault();\n    if (event.code !== \"Enter\") return;\n    if (!messageInput.value) return;\n    const date = new Date();\n    ws.send(\n      JSON.stringify({ name: senderName, date, message: messageInput.value }),\n    );\n    messageInput.value = \"\";\n  });\n\n  window.addEventListener(\"beforeunload\", () => {\n    api.deleteUser({ name: senderName });\n    ws.send(JSON.stringify({ closed: senderName }));\n  });\n\n  ws.addEventListener(\"open\", (e) => {\n    ws.send(JSON.stringify({ senderName }));\n  });\n\n  ws.addEventListener(\"close\", (e) => {\n    console.log(e);\n    console.log(\"close ws\");\n  });\n\n  ws.addEventListener(\"error\", (e) => {\n    console.log(e);\n    console.log(\"error ws\");\n  });\n\n  ws.addEventListener(\"message\", (e) => {\n    const data = JSON.parse(e.data);\n    const { closed } = data;\n    const { chat: messages } = data;\n    const { senders } = data;\n    if (messages) {\n      messages.forEach((message) => {\n        chat.addMessage(message);\n      });\n    } else if (senders) {\n      senders.forEach((sender) => {\n        users.addUser(sender);\n      });\n    } else if (closed) {\n      const userClosed = closed[0].closed;\n      const allUsers = [...users.usersBox.querySelectorAll(\".user-name\")];\n      allUsers.forEach((user) => {\n        if (user.textContent === userClosed) {\n          let item = user.closest(\".user-item\");\n          item.remove();\n        }\n      });\n    }\n  });\n};\n\n//___________________ login___________________\n\nconst showModalIncorrectName = () => {\n  const modalIncorrectName = document.querySelector(\".modal-incorrect-name\");\n  modalIncorrectName.style.display = \"flex\";\n  const incorrectNameButton = modalIncorrectName.querySelector(\n    \".incorrect-name-button\",\n  );\n  const toCloseModal = () => {\n    modalIncorrectName.style.display = \"none\";\n    toRegister();\n  };\n  incorrectNameButton.addEventListener(\"click\", toCloseModal);\n};\n\nconst toLogin = (response) => {\n  const chatWidget = document.querySelector(\".chat-widget\");\n  const usersList = document.querySelector(\".users-list>ul\");\n  const userItem = document.createElement(\"li\");\n  userItem.classList = \"user-item\";\n  userItem.dataset.name = response.name;\n  const userImage = document.createElement(\"div\");\n  userImage.classList = \"user-image\";\n  const userName = document.createElement(\"span\");\n  userName.classList = \"user-name\";\n  userName.classList.add(\"you\");\n  userName.textContent = \"You\";\n  userItem.appendChild(userImage);\n  userItem.appendChild(userName);\n  usersList.appendChild(userItem);\n  chatWidget.style.display = \"flex\";\n};\n\nconst toRegister = () => {\n  const modalRegister = document.querySelector(\".modal-register\");\n  modalRegister.style.display = \"flex\";\n  const registerName = modalRegister.querySelector(\".register-name\");\n  const registerButton = modalRegister.querySelector(\".register-button\");\n  const toSubmit = () => {\n    event.preventDefault();\n    const name = registerName.value;\n    if (name === \"\") return;\n    registerName.value = \"\";\n    api.addUser({ name }).then((response) => {\n      if (response.status === \"name already use\") {\n        modalRegister.style.display = \"none\";\n        showModalIncorrectName();\n      } else {\n        modalRegister.style.display = \"none\";\n        toLogin(response);\n        api.getUser().then((response) => {\n          response.forEach((sender) => {\n            users.addUser(sender);\n          });\n          runWebSocket();\n        });\n      }\n    });\n\n    registerButton.removeEventListener(\"click\", toSubmit);\n  };\n  registerButton.addEventListener(\"click\", toSubmit);\n};\n\ndocument.addEventListener(\"DOMContentLoaded\", toRegister);\n","import \"./css/style.css\";\nimport \"./js/app\";\n"],"names":["Api","constructor","apiUrl","addUser","user","request","fetch","method","headers","body","JSON","stringify","result","json","getUser","deleteUser","query","encodeURIComponent","name","ok","console","error","status","log","Users","usersBox","data","userItems","document","querySelectorAll","sender","filter","item","dataset","senderName","createUser","appendChild","createElement","classList","userImage","userName","textContent","Messages","messagesBox","addMessage","message","createMessage","dataMessage","date","getDate","add","textMessage","dateString","formattedDate","Date","toLocaleString","day","month","year","hour","minute","hour12","split","join","api","querySelector","users","runWebSocket","chat","messageInput","ws","WebSocket","addEventListener","event","preventDefault","code","value","send","window","closed","e","parse","messages","senders","forEach","userClosed","allUsers","closest","remove","showModalIncorrectName","modalIncorrectName","style","display","incorrectNameButton","toCloseModal","toRegister","toLogin","response","chatWidget","usersList","userItem","modalRegister","registerName","registerButton","toSubmit","then","removeEventListener"],"sourceRoot":""}